# Expert Python Programmer

You are an expert Python programmer. You have a deep understanding of the Python language and its various libraries. You are capable of writing clean, efficient, and maintainable code. You are also familiar with best practices for Python development, including proper use of libraries, code organization, testing,and documentation.

# Refactoring Python Code

- I want you to review this code and provide feedback on its readability, maintainability, and adherence to best practices.
- Please provide specific suggestions with examples on how the code can be improved.
- All functions should have type annotations and docstrings.
- The code should have sufficient unit test coverage.
- The code should have proper error handling and logging.
- If a function is doing too much, it should be refactored into two or more smaller functions.

# Functional Programming in Python

## Resources

- [Functional Programming HOWTO](https://docs.python.org/3/howto/functional.html)
- [Professor Frisby's Mostly Adequate Guide to Functional Programming](https://mostly-adequate.gitbook.io/mostly-adequate-guide/)

## Prompt


I have two postgres tables:

-- DDL generated by Postico 2.1.1
-- Not all database features are supported. Do not use for backup.

-- Table Definition ----------------------------------------------

CREATE TABLE populi_data.courseofferings (
    object character varying,
    id bigint NOT NULL,
    academic_term_id bigint,
    campus_id bigint,
    finalized boolean,
    finalized_at timestamp with time zone,
    max_enrolled bigint,
    roster_visibility boolean,
    start_date character varying,
    end_date character varying,
    published boolean,
    open_to_students_date character varying,
    closed_to_students_date character varying,
    faculty_can_manage_roster boolean,
    faculty_can_override_enrollment boolean,
    disable_student_bulletin_board_posts boolean,
    students_can_add_discussions boolean,
    allow_auditor_assignments boolean,
    allow_auditor_attendance boolean,
    waiting_list_management character varying,
    report_data__course_offering_catalog_course_id bigint,
    report_data__name character varying,
    report_data__description character varying,
    report_data__catalog_course_id bigint,
    report_data__section character varying,
    report_data__credits character varying,
    report_data__hours character varying,
    report_data__pass_fail bigint,
    report_data__attendance_hours character varying,
    report_data__enable_clinical_hours bigint,
    report_data__clinical_hours character varying,
    report_data__fulfills_program_requirements bigint,
    report_data__affects_standing bigint,
    report_data__affects_full_time_status bigint,
    report_data__pass_affects_gpa bigint,
    report_data__fail_affects_gpa bigint,
    report_data__pass_fail_pass_affects_gpa bigint,
    report_data__pass_fail_fail_affects_gpa bigint,
    report_data__course_abbrv character varying,
    report_data__department_name character varying,
    report_data__campus_name character varying,
    report_data__num_finalized_students character varying,
    report_data__num_students character varying,
    report_data__num_auditors character varying,
    report_data__num_incomplete character varying,
    report_data__num_withdrawn character varying,
    report_data__num_waiting bigint,
    report_data__primary_faculty_id bigint,
    report_data__primary_faculty_display_name character varying,
    report_data__primary_faculty_first_name character varying,
    report_data__primary_faculty_last_name character varying,
    report_data__primary_faculty_email_address character varying,
    report_data__add_drop_time_local timestamp with time zone,
    report_data__department_id bigint,
    report_data__program_name_ids character varying,
    report_data__hide_self_register bigint,
    report_data__self_enroll character varying,
    report_data__self_audit bigint,
    report_data__delivery_method_ids character varying,
    report_data__delivery_method_names character varying,
    report_data__primary_delivery_method_id bigint,
    report_data__primary_delivery_method_name character varying,
    report_data__has_course_evaluation bigint,
    report_data__num_course_evaluation_completions character varying,
    report_data__row_id bigint,
    show_progress_to_students boolean,
    _dlt_load_id character varying NOT NULL,
    _dlt_id character varying NOT NULL UNIQUE,
    report_data__teaching_assistants character varying,
    report_data__teaching_assistant_email_addresses character varying
);

-- Indices -------------------------------------------------------

CREATE UNIQUE INDEX courseofferings__dlt_id_key ON populi_data.courseofferings(_dlt_id text_ops);


and this table:

-- DDL generated by Postico 2.1.1
-- Not all database features are supported. Do not use for backup.

-- Table Definition ----------------------------------------------

CREATE TABLE populi_data.enrollments (
    object character varying,
    id bigint,
    first_name character varying,
    last_name character varying,
    middle_name character varying,
    display_name character varying,
    gender character varying,
    raceid bigint,
    image_file_id bigint,
    birth_date character varying,
    status character varying,
    social_security_number character varying,
    updated_at timestamp with time zone,
    hispanic_latino boolean,
    resident_alien boolean,
    added_by_id bigint,
    added_at timestamp with time zone,
    report_data__student_person_id bigint,
    report_data__student_name character varying,
    report_data__academic_term_id bigint,
    report_data__academic_term_name character varying,
    report_data__catalog_course_abbrv character varying,
    report_data__course_offering_id bigint,
    report_data__full_course_offering_name character varying,
    report_data__course_student_status character varying,
    report_data__programid bigint,
    report_data__grade_abbrv character varying,
    report_data__grade character varying,
    report_data__enrollment_id bigint,
    report_data__pass_fail bigint,
    report_data__student_middle_name character varying,
    report_data__student_preferred_name character varying,
    report_data__academic_term_start_date character varying,
    report_data__course_campus_id bigint,
    report_data__academic_term_end_date character varying,
    report_data__student_first_name character varying,
    report_data__student_last_name character varying,
    report_data__course_offering_section character varying,
    report_data__course_offering_name character varying,
    report_data__credits character varying,
    report_data__hours character varying,
    report_data__course_campus_name character varying,
    report_data__finalized bigint,
    report_data__program_units character varying,
    report_data__catalog_course_id bigint,
    report_data__row_id character varying,
    private_profile boolean,
    is_user boolean,
    _dlt_load_id character varying NOT NULL,
    _dlt_id character varying NOT NULL UNIQUE,
    report_data__program_name character varying,
    report_data__course_offering_student_program_id bigint,
    preferred_name character varying,
    bio character varying,
    notification_email_id bigint,
    prefix character varying,
    social_insurance_number character varying,
    suffix character varying,
    former_name character varying,
    license_plate character varying
);

-- Indices -------------------------------------------------------

CREATE UNIQUE INDEX enrollments__dlt_id_key ON populi_data.enrollments(_dlt_id text_ops);


I want to combine these two tables into one.